<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartHirn Prompt Engine</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .animate-in {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .custom-scroll::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #103030;
            border-radius: 10px;
        }
    </style>
</head>
<body class="bg-[#F9FAFB]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, memo } = React;
        
        /**
         * Icon Wrapper für maximale Kompatibilität
         */
        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current && window.lucide) {
                    iconRef.current.innerHTML = '';
                    const iconData = lucide.icons[name];
                    if (iconData) {
                        const iconElement = lucide.createIcons({
                            icons: { [name]: iconData },
                            attrs: { 
                                strokeWidth: 2,
                                width: size,
                                height: size,
                                class: className
                            }
                        });
                    }
                }
            }, [name, size, className]);
            return <span ref={iconRef} className="inline-flex items-center justify-center"></span>;
        };

        // --- Stabile Input Komponenten um Cursor-Sprünge zu vermeiden ---
        
        const InputField = memo(({ label, value, onChange, placeholder, icon }) => (
            <div className="space-y-2">
                <label className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] flex items-center gap-2 ml-1">
                    {icon && <Icon name={icon} size={12} className="opacity-40" />} {label}
                </label>
                <input
                    type="text"
                    value={value}
                    onChange={(e) => onChange(e.target.value)}
                    placeholder={placeholder}
                    className="w-full bg-white border-2 border-slate-100 rounded-2xl px-5 py-3.5 text-slate-700 font-medium focus:outline-none focus:border-[#103030] transition-all shadow-sm"
                />
            </div>
        ));

        const MultiSelectChannels = memo(({ selectedChannels, onChange }) => {
            const channels = ["Instagram", "TikTok", "LinkedIn", "YouTube", "Facebook", "Twitter/X"];
            
            const toggleChannel = (channel) => {
                if (selectedChannels.includes(channel)) {
                    onChange(selectedChannels.filter(c => c !== channel));
                } else {
                    onChange([...selectedChannels, channel]);
                }
            };

            return (
                <div className="space-y-3">
                    <label className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] flex items-center gap-2 ml-1">
                        <Icon name="Share2" size={12} className="opacity-40" /> Kanäle
                    </label>
                    <div className="flex flex-wrap gap-2">
                        {channels.map(channel => (
                            <button
                                key={channel}
                                onClick={() => toggleChannel(channel)}
                                className={`px-4 py-2 rounded-xl text-xs font-bold transition-all border-2 ${
                                    selectedChannels.includes(channel)
                                    ? 'bg-[#103030] border-[#103030] text-[#F8D800] shadow-md'
                                    : 'bg-white border-slate-100 text-slate-400 hover:border-slate-200'
                                }`}
                            >
                                {channel}
                            </button>
                        ))}
                    </div>
                </div>
            );
        });

        const TagInput = memo(({ label, tags, onAdd, onRemove, icon, colorClass = "bg-slate-100" }) => {
            const [val, setVal] = useState('');
            return (
                <div className="space-y-3">
                    <label className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] flex items-center gap-2 ml-1">
                        {icon && <Icon name={icon} size={12} className="opacity-40" />} {label}
                    </label>
                    <div className="flex gap-2">
                        <input
                            type="text"
                            value={val}
                            onChange={(e) => setVal(e.target.value)}
                            onKeyDown={(e) => { if (e.key === 'Enter' && val) { onAdd(val); setVal(''); }}}
                            className="flex-1 bg-white border-2 border-slate-100 rounded-2xl px-5 py-3 text-slate-700 focus:outline-none focus:border-[#103030]"
                            placeholder="Hinzufügen..."
                        />
                        <button 
                            onClick={() => { if(val) { onAdd(val); setVal(''); }}}
                            className="p-3 bg-[#103030] hover:bg-[#1a4a4a] text-[#F8D800] rounded-2xl transition-all shadow-lg"
                        >
                            <Icon name="Plus" size={24} />
                        </button>
                    </div>
                    <div className="flex flex-wrap gap-2 pt-2">
                        {tags.map((tag, i) => (
                            <span key={tag + i} className={`flex items-center gap-2 ${colorClass} text-[#103030] border border-slate-200 px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider`}>
                                {tag}
                                <button onClick={() => onRemove(tag)} className="hover:text-red-500 transition-colors">
                                    <Icon name="X" size={12} />
                                </button>
                            </span>
                        ))}
                    </div>
                </div>
            );
        });

        const App = () => {
            // --- Konfiguration & Konstanten ---
            const ANTI_GENERIC_RULES = [
                "Keine leeren Claims (z.B. „innovativ“, „revolutionär“).",
                "Keine Floskeln wie „Entdecke“ oder „In diesem Beitrag“.",
                "Konkrete Beispiele und Zahlen einbauen (statt 'viele' schreib '126').",
                "Kurze Sätze. Aktiv statt Passiv. Direkte Ansprache.",
                "Brand Voice konsequent einhalten: Weniger Marketing-Bla, mehr Experten-Expertise.",
                "No-Go-Wörter strikt vermeiden.",
                "Keine Emojis, außer ausdrücklich gewünscht.",
                "Verwende das 'Problem-Agitation-Solution' Framework für Captions."
            ];

            // --- State Management ---
            const [activeTab, setActiveTab] = useState('brand');
            const [currentBrand, setCurrentBrand] = useState({
                brand_name: 'Stitch & Line',
                offer: 'Individuelle T‑Shirt-Designs für Creator in 72 Stunden.',
                audience: 'Creator und kleine E‑Com Brands (1–5 Personen).',
                channels: ['Instagram', 'TikTok'],
                usp_1: '72h Delivery: Druckdateien + Mockups',
                usp_2: 'Stil-Check: Designs passen zum Brand-Style',
                usp_3: 'Merch-Conversion Fokus',
                brand_voice_adjectives: ['klar', 'direkt', 'kreativ'],
                no_go_words: ['revolutionär', 'bahnbrechend', 'entdecken'],
                cta: 'Schreib „MERCH“ per DM.',
                competitors: ['Fiverr Designer', 'Canva Templates']
            });

            const [campaign, setCampaign] = useState({
                objective: 'Mehr qualifizierte Anfragen per DM',
                funnel_stage: 'conversion',
                tone: 'bold',
                content_pillar: 'Social Proof / Case Studies',
                audience_segment: 'Creator ohne Design-Skills'
            });

            const [generatedPrompt, setGeneratedPrompt] = useState('');
            const [copied, setCopied] = useState(false);

            // --- Handlers ---
            const updateBrand = (key, value) => setCurrentBrand(prev => ({ ...prev, [key]: value }));
            const updateCampaign = (key, value) => setCampaign(prev => ({ ...prev, [key]: value }));

            const handleGeneratePrompt = () => {
                const prompt = `
ROLLE: Senior Content-Stratege & psychologischer Copywriter.
KONTEXT:
- MARKE: ${currentBrand.brand_name}
- ANGEBOT: ${currentBrand.offer}
- ZIELGRUPPE: ${currentBrand.audience} (Segment: ${campaign.audience_segment})
- KANÄLE: ${currentBrand.channels.join(', ')}
- WETTBEWERBER: ${currentBrand.competitors.join(', ')}

STRATEGIE:
- PHASE: ${campaign.funnel_stage.toUpperCase()}
- THEMA: ${campaign.content_pillar}
- TON: ${currentBrand.brand_voice_adjectives.join(', ')} (Vibe: ${campaign.tone})

USPs:
1. ${currentBrand.usp_1}
2. ${currentBrand.usp_2}
3. ${currentBrand.usp_3}

AUFGABE: Erstelle Content für ${currentBrand.channels.join(' & ')}. Nutze für Videos [HOOK -> AGITATION -> PROOF -> CTA].

ANTI-GENERIC REGELN:
${ANTI_GENERIC_RULES.join('\n')}
VERBOTENE WÖRTER: ${currentBrand.no_go_words.join(', ')}
CTA: ${currentBrand.cta}
                `.trim();

                setGeneratedPrompt(prompt);
                const textArea = document.createElement("textarea");
                textArea.value = prompt;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
                document.body.removeChild(textArea);
            };

            return (
                <div className="min-h-screen p-4 md:p-10">
                    <div className="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-[300px_1fr] gap-10">
                        
                        {/* Sidebar */}
                        <aside className="space-y-10 flex flex-col">
                            <div className="bg-white border border-slate-200 p-8 rounded-[2.5rem] shadow-sm flex flex-col items-center text-center">
                                <h1 className="text-2xl font-[900] tracking-tighter text-[#103030] uppercase leading-none">
                                    SMART<span className="text-[#F8D800]">HIRN</span>
                                </h1>
                                <p className="text-[9px] text-slate-400 font-bold uppercase tracking-[0.3em] mt-2">Strategy master v0.1</p>
                            </div>

                            <nav className="flex flex-col space-y-3">
                                <button onClick={() => setActiveTab('brand')} className={`flex items-center space-x-3 px-6 py-4 rounded-2xl transition-all ${activeTab === 'brand' ? 'bg-[#103030] text-[#F8D800] shadow-xl' : 'text-slate-400 hover:bg-slate-100'}`}>
                                    <Icon name="ShieldCheck" size={20} />
                                    <span className="font-black uppercase text-[11px] tracking-widest">Brand Identity</span>
                                </button>
                                <button onClick={() => setActiveTab('campaign')} className={`flex items-center space-x-3 px-6 py-4 rounded-2xl transition-all ${activeTab === 'campaign' ? 'bg-[#103030] text-[#F8D800] shadow-xl' : 'text-slate-400 hover:bg-slate-100'}`}>
                                    <Icon name="Target" size={20} />
                                    <span className="font-black uppercase text-[11px] tracking-widest">Strategie Setup</span>
                                </button>
                                <button onClick={() => setActiveTab('generator')} className={`flex items-center space-x-3 px-6 py-4 rounded-2xl transition-all ${activeTab === 'generator' ? 'bg-[#103030] text-[#F8D800] shadow-xl' : 'text-slate-400 hover:bg-slate-100'}`}>
                                    <Icon name="PenTool" size={20} />
                                    <span className="font-black uppercase text-[11px] tracking-widest">Prompt Engine</span>
                                </button>
                            </nav>

                            <div className="bg-[#103030] rounded-[2rem] p-7 text-white shadow-2xl mt-auto overflow-hidden">
                                <p className="text-lg font-black uppercase leading-tight mb-2 truncate">{currentBrand.brand_name}</p>
                                <p className="text-[11px] text-slate-400 italic line-clamp-2">"{currentBrand.offer}"</p>
                            </div>
                        </aside>

                        {/* Main Content Area */}
                        <main className="bg-white border border-slate-200 rounded-[3.5rem] shadow-xl overflow-hidden min-h-[850px]">
                            <div className="p-10 md:p-14">
                                
                                {activeTab === 'brand' && (
                                    <div className="space-y-12 animate-in">
                                        <h2 className="text-4xl font-black text-[#103030] uppercase tracking-tight">01. Brand Setup</h2>
                                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-10">
                                            <div className="space-y-8">
                                                <InputField label="Markenname" icon="Briefcase" value={currentBrand.brand_name} onChange={(v) => updateBrand('brand_name', v)} />
                                                <InputField label="Zielgruppe" icon="Users" value={currentBrand.audience} onChange={(v) => updateBrand('audience', v)} />
                                                <div className="space-y-2">
                                                    <label className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] ml-1">Angebot</label>
                                                    <textarea 
                                                        value={currentBrand.offer}
                                                        onChange={(e) => updateBrand('offer', e.target.value)}
                                                        className="w-full h-24 bg-white border-2 border-slate-100 rounded-2xl px-5 py-4 text-slate-700 focus:outline-none focus:border-[#103030]"
                                                    />
                                                </div>
                                                <InputField label="USP 1" value={currentBrand.usp_1} onChange={(v) => updateBrand('usp_1', v)} />
                                                <InputField label="USP 2" value={currentBrand.usp_2} onChange={(v) => updateBrand('usp_2', v)} />
                                                <InputField label="USP 3" value={currentBrand.usp_3} onChange={(v) => updateBrand('usp_3', v)} />
                                            </div>
                                            <div className="space-y-8">
                                                <MultiSelectChannels selectedChannels={currentBrand.channels} onChange={(v) => updateBrand('channels', v)} />
                                                <TagInput label="Wettbewerber" icon="Target" tags={currentBrand.competitors} onAdd={(t) => updateBrand('competitors', [...currentBrand.competitors, t])} onRemove={(t) => updateBrand('competitors', currentBrand.competitors.filter(x => x !== t))} />
                                                <TagInput label="Brand Voice" icon="Mic" tags={currentBrand.brand_voice_adjectives} colorClass="bg-[#F8D800]/20" onAdd={(t) => updateBrand('brand_voice_adjectives', [...currentBrand.brand_voice_adjectives, t])} onRemove={(t) => updateBrand('brand_voice_adjectives', currentBrand.brand_voice_adjectives.filter(x => x !== t))} />
                                                <TagInput label="No-Go Wörter" icon="Trash2" tags={currentBrand.no_go_words} colorClass="bg-red-50" onAdd={(t) => updateBrand('no_go_words', [...currentBrand.no_go_words, t])} onRemove={(t) => updateBrand('no_go_words', currentBrand.no_go_words.filter(x => x !== t))} />
                                                <InputField label="CTA" value={currentBrand.cta} onChange={(v) => updateBrand('cta', v)} />
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'campaign' && (
                                    <div className="space-y-12 animate-in">
                                        <h2 className="text-4xl font-black text-[#103030] uppercase tracking-tight">02. Strategie Setup</h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                                            <div className="bg-slate-50 p-10 rounded-[3rem] border border-slate-200 space-y-8">
                                                <h3 className="text-[#103030] font-black uppercase text-xs tracking-[0.2em]">Funnel Stage</h3>
                                                <div className="grid grid-cols-1 gap-3">
                                                    {['awareness', 'consideration', 'conversion'].map(stage => (
                                                        <button key={stage} onClick={() => updateCampaign('funnel_stage', stage)} className={`py-4 px-6 text-xs font-black uppercase tracking-widest rounded-2xl border-2 transition-all ${campaign.funnel_stage === stage ? 'bg-[#103030] border-[#103030] text-[#F8D800]' : 'bg-white border-slate-200 text-slate-400'}`}>
                                                            {stage}
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                            <div className="space-y-8">
                                                <InputField label="Kampagnen-Ziel" icon="Flag" value={campaign.objective} onChange={(v) => updateCampaign('objective', v)} />
                                                <InputField label="Segment" value={campaign.audience_segment} onChange={(v) => updateCampaign('audience_segment', v)} />
                                                <InputField label="Inhaltstyp" value={campaign.content_pillar} onChange={(v) => updateCampaign('content_pillar', v)} />
                                                <div className="space-y-2">
                                                    <label className="text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em] ml-1">Vibe</label>
                                                    <select value={campaign.tone} onChange={(e) => updateCampaign('tone', e.target.value)} className="w-full bg-white border-2 border-slate-100 rounded-2xl px-5 py-3.5 text-slate-700 font-bold uppercase text-xs focus:outline-none focus:border-[#103030]">
                                                        <option value="bold">Bold</option>
                                                        <option value="empathic">Empathisch</option>
                                                        <option value="authoritative">Kompetent</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {activeTab === 'generator' && (
                                    <div className="h-full flex flex-col items-center justify-center text-center py-10 animate-in">
                                        <div className="w-24 h-24 bg-[#103030] rounded-full flex items-center justify-center mb-8 shadow-2xl">
                                            <Icon name="Zap" size={40} className="text-[#F8D800] fill-[#F8D800]" />
                                        </div>
                                        <h2 className="text-5xl font-black text-[#103030] uppercase tracking-tighter mb-4">Prompt Engine</h2>
                                        <button onClick={handleGeneratePrompt} className="group relative bg-[#103030] text-[#F8D800] px-12 py-6 rounded-3xl font-black text-xl uppercase tracking-tighter shadow-2xl transition-all hover:scale-105 active:scale-95 flex items-center gap-4">
                                            <Icon name={copied ? "CheckCircle" : "Zap"} size={28} />
                                            <span>{copied ? "Kopiert!" : "Erstellen"}</span>
                                        </button>
                                        {generatedPrompt && (
                                            <div className="mt-10 p-6 bg-slate-50 rounded-2xl border border-slate-200 w-full max-w-3xl text-left font-mono text-[10px] text-slate-500 whitespace-pre-wrap max-h-[300px] overflow-y-auto custom-scroll shadow-inner">
                                                {generatedPrompt}
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </main>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
